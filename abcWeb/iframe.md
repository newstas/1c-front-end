# iframe — встроенная страница

`<iframe>` — это контейнер, который позволяет вставить любой HTML-документ из другого источника. Часто этот документ интерактивный — например, карта, видео или пост из соцсети.

Этот контейнер обычно называют фреймом. Внешний вид фрейма и его положение на странице можно задать через CSS.

Тег `<iframe>` позволяет встраивать контент (например, веб-страницы, видео) прямо в ваш документ HTML.

**Простейший пример** использования `<iframe>`:
```html
<iframe src="https://example.com" width="600" height="400"></iframe>
```
Атрибут `src` задаёт URL-адрес страницы, которую вы хотите встроить.

**Еще пример**. С помощью такого нехитрого кода мы можем встроить карту размером 560 на 400 пикселей на любую страницу:
```html
<iframe
  id="inlineFrameExample"
  title="Inline Frame Map"
  width="560"
  height="400"
  frameborder="1"
  allowfullscreen="true"
  src="https://yandex.ru/map-widget/v1/-/CBFkaYSE0A"
>
</iframe>
```
Атрибуты `width` и `height` — ширина и высота фрейма (можно задавать как в пикселях, так и в процентах):
- `height` — высота фрейма.
- `width` — ширина фрейма.

Для изменения размеров фрейма средствами HTML предусмотрены атрибуты width и height. Допускается использовать 
**значения в пикселях** или **процентах**. Если установлена процентная запись, то размеры фрейма вычисляются относительно 
родительского элемента — контейнера, где находится элемент `<iframe>`. В случае отсутствия родительского контейнера, 
в его качестве выступает окно браузера. Иными словами, **`width="100%"` означает, что фрейм будет занимать всю ширину веб-страницы**.

Если значение высоты или ширины не заданы, то фрейм автоматически принимает размер 300х150 пикселей:

**Значение по умолчанию**:
- `width` — 300 пикселей, 
- `height` — 150 пикселе

**Пример с использованием srcdoc**:
```html
<iframe
  width=400 
  height=300
  srcdoc=
    "<!doctype html><hr />iframe - I'm in a `@srcdoc` attribute!
    <script> alert('I\'m generated by a `@srcdoc`!'); //console.log('I\'m generated by a @srcdoc!');</script>"
>
[no frames]
</iframe>
```

**Пример с сайтом example.org**

В этом примере страница [example.org](https://example.org) встраивается в `iframe`. Это распространенный вариант 
использования `iframe`: встраивание контента с другого сайта.
```html
<iframe
  title="iframe Простой пример"
  width="400"
  height="300">
  src="https://example.org"
</iframe>
```

### Как понять

`<iframe>` можно представить как «окно» или фрейм, через которое на вашей странице можно увидеть любое содержимое с других сайтов. Это значит, что если карту, видео, пост или другой элемент удалят с оригинального сайта, он пропадёт и с вашей страницы. Останется только пустое место или надпись вроде «Контент недоступен».

Встраивать файлы можно либо по ссылке с помощью атрибута `src`, либо целиком HTML-код файла с помощью `srcdoc`.


## Все атрибуты

`src` — URL-адрес файла, который вы встраиваете.

`srcdoc` — позволяет встроить HTML-код целиком, так что браузеру не придётся подгружать что-то по внешней ссылке. Если используется этот атрибут, то ссылка `src` игнорируется.

`sandbox`

`sandbox` — ограничивает определённые действия и функции встраиваемого документа. Это важный атрибут с точки зрения безопасности. Он позволяет контролировать, какие активности разрешены внутри `<iframe>`. 

Возможные значечения атрибута `sandbox`:
- `allow-forms` — позволяет отправлять формы внутри <iframe>.
- `allow-modals` — позволяет открывать модальные окна, которые мы все так не любим: вроде «Оставьте свой имейл» или «Не уходите так быстро! У вас товар в корзине». Обычно эти окна не дают пользоваться сайтом, пока их не закроешь.
- `allow-orientation-lock` — позволяет фиксировать горизонтальное или вертикальное положение экрана.
- `allow-pointer-lock` — позволяет (**сюрприз!**) блокировать указатель; позволяет пользователю управлять содержимым <iframe> с помощью курсора через Pointer Lock API.
- `allow-popups` — разрешает (**шок!**) показ всплывающих окон, вызванных с помощью window.open(), target="_blank" или showModalDialog().
- `allow-popups-to-escape-sandbox` — позволяет содержимому фрейма открывать новые окна. С этим параметром у таких окон не будет тех ограничений, которые есть у <iframe> с атрибутом sandbox.
- `allow-presentation` — разрешает использовать Presentation API.
- `allow-same-origin` — контент из <iframe> загружается по тем же правилам и с теми же ограничениями, что и страница, на которой он находится.
- `allow-scripts` — позволяет загружать скрипты. При этом всплывающие окна будут запрещены.
- `allow-top-navigation` — позволяет открывать ссылки, которые есть в <iframe>, в том же окне, в которое встроен фрейм.
- `allow-top-navigation-by-user-activation` — позволяет контенту из фрейма управлять страницей, на которой он находится. Но только по инициативе пользователя.

Если просто указать атрибут sandbox, то он применит сразу все возможные ограничения. Либо можно указать нужные ограничения в любом порядке через пробел:

`<iframe src="https://example.com" sandbox="allow-scripts allow-same-origin"></iframe>`

Значение allow-scripts разрешает выполнение скриптов внутри фрейма, а allow-same-origin позволяет фрейму обращаться к ресурсам его исходной страницы.

> Элементы `iframe` — это первый шаг к созданию хорошей структуры. Загрузка ненадежного компонента в `iframe` **обеспечивает определенную степень разделения между вашим приложением и содержимым,** которое вы хотите загрузить. **Содержимое в рамке не будет иметь доступа к DOM вашей страницы или данным**, которые вы сохранили локально, а также не сможет рисоваться в произвольных позициях на странице; его объем ограничен контуром кадра. Однако разделение не является действительно надежным. Содержимая страница **по-прежнему имеет ряд возможностей для раздражающего или вредоносного поведения**: *автоматическое воспроизведение видео, плагины и всплывающие окна* — это верхушка айсберга.

> Атрибут sandbox элемента `iframe` дает нам именно то, что нам нужно, **чтобы ужесточить ограничения на контент в фреймах**. Мы можем поручить браузеру загружать содержимое определенного фрейма в среде с низким уровнем привилегий, разрешая только подмножество возможностей, необходимых для выполнения любой работы.


`loading`

Атрибут `loading` может помочь с оптимизацией производительности и отложить загрузку `iframe` до тех пор, пока это не будет необходимо.

Можно использовать ленивую загрузку с поьощью атрибута `loading = "lazy"`, чтобы не замелять загрузку страницы:

```html
<iframe src="https://example.com" loading="lazy"></iframe>
```


`allowfullscreen, allowpaymentrequest`

Здесь всё просто и следует из названия:
- `allowfullscreen`: позволяет встроенному контенту открываться в полноэкранном режиме.
- `allowpaymentrequest`: позволяет встроенному контенту делать запросы на оплату.
    

`title`

Не забывайте об универсальных атрибутах, таких как `title`, которые способствуют улучшению доступности.

```html
<iframe src="https://example.com" title="Example Content"></iframe>
```


`name`

`name` — имя фрейма. Пригодится, чтобы создать ссылку, по которой новая страница будет открываться в нужном фрейме (в основном используется для ссылки на элемент в JavaScript).


`frameborder`

Атрибут/параметр `frameborder` (от англ. **frame border** ‒ «рамка кадра») *добавляет или удаляет рамку вокруг встроенного фрейма*.


## Стилизация

`<iframe>` можно стилизовать, как и любой другой элемент. Но помните, что стили вашей родительской страницы не применяются к содержимому `<iframe>`, и вы не сможете его **стилизовать через CSS** в родительском документе.
```html
iframe {
  border: none; 
}
```

**Пример стилизации**:

**HTML**
```HTML
<iframe
  id="inlineFrameExample"
  title="Inline Frame Example"
  width="300"
  height="200"
  allow="fullscreen"
  src="https://www.openstreetmap.org/export/embed.html?bbox=-0.004017949104309083%2C51.47612752641776%2C0.00030577182769775396%2C51.478569861898606&layer=mapnik">
</iframe>
```

**CSS**
```css
  border: 1px solid black;
  width: 100%; /* имеет приоритет над шириной, установленной с помощью атрибута ширины HTML */
}
```


## Отслеживание событий загрузки

Вы можете отслеживать событие load для <iframe>, чтобы знать, когда встроенный контент загружен.
```html
document.querySelector('iframe').addEventListener('load', function() {
  console.log('Iframe is loaded!'); 
});
```

# Встраивание исходного кода в `<iframe>`  c помощью `srcdoc`

```html
<article>
  <footer>Nine minutes ago, <i>jc</i> wrote:</footer>
  <iframe
    width="500"
    height="250"
    sandbox
    srcdoc=
      "<p>There are two ways to use the <code>iframe</code> element:</p>
      <ol>
      <li><a href=&quot;about:srcdoc#embed_another&quot;>To embed content from another page</a></li>
      <li><a href=&quot;about:srcdoc#embed_user&quot;>To embed user-generated content</a></li>
      </ol>
      <h2 id=&quot;embed_another&quot;>Embedding content from another page</h2>
      <p>Use the <code>src</code> attribute to specify the URL of the page to embed:</p>
      <pre><code>&amp;lt;iframe src=&quot;https://example.org&quot;&amp;gt;&amp;lt;/iframe&amp;gt;</code></pre>
      <h2 id=&quot;embed_user&quot;>Embedding user-generated content</h2>
      <p>Use the <code>srcdoc</code> attribute to specify the content to embed. This post is already an example!</p>"
>
</iframe>
</article>
```

Вот как писать escape-последовательности при использовании `srcdoc`:
- Сначала напишите HTML, экранируя все, что можно было бы экранировать в обычном HTML-документе (например, `<`, `>`, `&`, и т. д.).
- `&lt;` и `<` представляют собой один и тот же персонаж в `srcdoc` атрибут. Поэтому, чтобы сделать не нарушить escape-последовательность в документе HTML, **замените все амперсанды (`&`) на `&amp;`**. Например, `&lt;` становится `&amp;lt;`, а `&amp;` становится `&amp;amp;`.
- **Замените все двойные кавычки `"` на `&quot;`** чтобы предотвратить srcdoc атрибут от преждевременного завершения (если вы используете одинарные кавычки `'` вместо этого вам следует заменить `'` на `&apos;`). Этот шаг происходит после предыдущего, **поэтому `&quot;` созданный на этом этапе, не становится `&amp;quot;`**.




# `src` и `srcdoc` в `iframe` HTML5: разница и применение

Атрибут `srcdoc` позволяет непосредственно встраивать HTML-содержимое в `<iframe>`, делая код более читаемым и интуитивным. 
В то же время атрибут src, использующий **Data URI**, требует преобразования HTML в формат URL, что может быть неудобно, 
особенно при работе с большими объемами данных. Использование `srcdoc` упрощает процесс и обеспечивает лучшую читаемость 
встроенного кода:

`srcdoc` пример использования:
```html
<iframe srcdoc="<p>Привет, мир!</p>"></iframe>
```

**Data URI** пример использования:
```html
<iframe src="data:text/html,<p>Привет, мир!</p>"></iframe>
```

Оба способа позволяют выводить текст "Привет, мир!" в `<iframe>`, однако `srcdoc` делает этот процесс более прямым 
и удобным для работы с HTML-контентом внутри `iframe`.


## Навигация по безопасности

Когда дело доходит до работы с ненадежным содержимым, srcdoc можно использовать в сочетании с атрибутом `sandbox` 
для обеспечения безопасности внутреннего содержимого. Стоит отметить, что поддержка srcdoc в старых браузерах может быть ограничена. 
Если для `<iframe>` заданы одновременно и `src`, и `srcdoc`, **преференция будет отдана `srcdoc`**, исключая запросы к внешним ресурсам.

Если вы используете **Internet Explorer 11, то `srcdoc` не будет поддерживаться**. Современные браузеры хорошо 
работают с `srcdoc`, делая его более безопасным для инлайн-содержимого. Тем не менее, использование `src` с **Data URI** 
может привлечь внимание злоумышленников, а также существуют ограничения на длину URL.


## Глубина содержимого – продвинутое управление

### Бесшовная интеграция и обход междоменных ограничений

`srcdoc` обеспечивает более плавное и прозрачное встраивание HTML-кода, исключая сложности с кодированием 
и увеличивая читабельность содержимого. Это позволяет создавать полноценные HTML-структуры внутри `<iframe>`, 
контролируя междоменные ограничения, которые могут возникнуть при использовании `src` с **Data URI**:

Пример использования `srcdoc` для встраивания:
```html
<iframe srcdoc="<style>h2 {color: red;}</style><h2>Стилизованный контент</h2>"></iframe>
```

### Работа с куками

Для `iframe` взаимодействие с куками может быть сложной задачей. Однако, `srcdoc` значительно облегчает этот процесс, 
предоставляя устойчивый контроль над куками. Использование `src` с **Data URI** требует учета ограничений по использованию кук 
в различных доменах, в то время как srcdoc является более надежным вариантом, работающим в рамках одного источника.

### Особенности браузеров

Важно учесть различия в поддержке `srcdoc` в разных браузерах, поскольку каждый из них может внести свои коррективы 
в работу с этим атрибутом. Например, Chrome работает с куками по-своему, и подход `srcdoc` приспосабливается к этой особенности. 
С другой стороны, использование src может столкнуться с особыми ограничениями браузера, такими как пределы длины URL и другие "тонкости".


## Не поддерживается браузером? Есть альтернативы

Если вам приходится работать со старыми браузерами, которые не поддерживают `srcdoc`, можно использовать методы передачи 
структурированных данных, такие как `postMessage` или серверные решения. Хотя они могут быть более сложными, 
они обеспечивают безопасность и возможность взаимодействия.

> Если браузер НЕ поддерживает атрибут `srcdoc`, вместо него будет отображаться файл, указанный в атрибуте `src` (если он присутствует).


Если браузер не поддерживает iframe, он будет отображать содержимое, включенное между открывающим тегом `<iframe> `
и закрывающим тегом `</ iframe>`.

Таким образом, вы всегда должны думать о том, чтобы разместить предупреждающее сообщение как запасной вариант для этих пользователей.
```html
<iframe>
  <p>Твой браузер устарел для отображения элемента iframe</p>
</iframe>
```


## Визуализация

`srcdoc` и `src` с **Data URI** в `<iframe>` можно представить как два разных способа упаковки багажа:

| Метод       | Техника упаковки багажа               | Описание                                         |
| --------------- | --------------------------------- |-------------------------------------------------|
| `srcdoc`        | Прямая упаковка                  | Предметы укладываются напрямую в чемодан      |
| `src=data`      | Упакованный чемодан               | Вставка уже упакованного чемодана в другой  |

Прямая упаковка `srcdoc` — объекты помещаются прямо в чемодан `iframe`:
```html
<iframe srcdoc="<p>Привет, inline!</p>"></iframe> // Мы прямо укладываем <p> в чемодан (iframe)
```

Упакованный чемодан `src=data` — чемодан уже упакован и помещается в другой:
```html
<iframe src="data:text/html;base64,PGgxPkhlbGxvLCBkYXRhIFVSSSE8L2gxPg=="></iframe> // Мы вкладываем упакованный объект (data URI) в большой чемодан
```

### Подход для больших объемов данных

Для работы с большим объемом HTML-содержимого рекомендуется предпочесть использование `srcdoc` вместо `src` с **Data URI**, 
чтобы избежать перегруженности атрибута. srcdoc является более эффективным выбором, потому что он отключает необходимость кодирования 
и декодирования больших объемов данных.

### Быстрая загрузка и пользовательский опыт

Содержимое, внедренное через `srcdoc`, загружается в процессе основной загрузки страницы, что **может улучшить показатели 
скорости загрузки**. Используйте `srcdoc` для ускорения загрузки встроенного контента и улучшения пользовательского опыта.
Обслуживание и поддержка

Отладка и поддержка становятся проще при использовании `srcdoc`, поскольку разработчики могут напрямую редактировать HTML 
непосредственно в родительском документе. Это облегчает рабочий процесс и способствует более плавному циклу разработки 
по сравнению с работой с заранее закодированными **data URI**.


# От `<object>` к `<iframe>` - другие технологии внедрения

Они позволяют встраивать в ваши веб-страницы самые разнообразные типы контента: 
`<iframe>`, `<embed>` и `<object>`. 

`<iframe>` предназначен для встраивания других веб-страниц, а `<embed>` и `<object>` позволяют встраивать **PDF-файлы**, 
**SVG** и даже **Flash** - устаревшую технологию, которую вы всё равно иногда увидите.

Не так давно (конец 90-х, начало 2000-х годов) технологии плагинов, такие как **Java-апплеты** и **Flash**, 
стали очень популярными - это позволило веб-разработчикам встраивать богатый контент в веб-страницы, 
такие как видео и анимации, которые просто не были доступны только через HTML. Внедрение этих технологий 
осуществлялось посредством таких элементов, как `<object>` и менее используемого `<embed>`, 
и они были очень полезны в то время. С тех пор они вышли из моды из-за многих проблем, включая доступность, 
безопасность, размер файла и многое другое; в наши дни большинство мобильных устройств больше не поддерживают такие плагины, 
и поддержка на компьютерах также уменьшается.

Наконец, появился элемент `<iframe>` (наряду с другими способами встраивания контента, например `<canvas>`, `<video>` и т. д. ) 
Он позволяет встраивать целый веб-документ внутри другого, как если бы это был <img> или другой подобный элемент, 
и сегодня используется повсеместно.

Существует много других технологий, которые включают в себя внедрение внешнего контента, 
например `<video>`, `<audio>` и `<img>`, но есть и другие. 
Например, `<canvas>` **для 2D-и 3D-графики, сгенерированной JavaScript**, 
и `<svg>` **для встраивания векторной графики**.


# Преимущества и недостатки

Правильное использование элементов iFrame оживляет страницы сайта и ускоряет разработку развлекательных проектов. 
С помощью фрейма легко реализовать рекламный блок на сайте, вставить трейлер фильма, добавить текстовый редактор, 
карту или форму. Но у фреймов есть ряд серьезных недостатков.

1. Злоупотребление элементами iFrame перегружает память — ноутбук или смартфон пользователя могут зависать.
По этой причине не стоит, например, создавать портфолио, в котором будут несколько десятков фреймов с атрибутом `eager`
для демонстрации всех лендингов, разработанных автором.
3. Включение фреймов в адаптивный дизайн требует от разработчика применения одного из известных решений:
  - оборачивания элементов `iFrame` в `<div>` с определенными CSS-свойствами;
  - установления соотношения сторон с помощью CSS;
  - использования готовой библиотеки **iFrame Resizer**.
3. Разработчик добавляет контент, который не может контролировать. Встраивание трейлера, расположенного на YouTube,
или трека, загруженного на SoundCloud, не представляет для сайта опасности. Но если встраивается контент
с менее надежной платформы, важно изучить тонкости атрибута sandbox.
4. **Боты не учитывают содержимое фреймов как часть контента сайта**.
5. Встраивание мультимедийного контента снижает показатели пользовательского опыта, если посетитель переходит
для просмотра на источник контента. Если трейлеры фильмов и обучающие видео находятся непосредственно на сайте,
показатели пользовательской активности помогут в продвижении ресурса.

## Отношение поисковых роботов к iFrame

Одно из самых популярных заблуждений в отношении iFrame гласит, что фреймы плохо влияют на индексацию сайта 
в поисковых системах. В течение нескольких лет после появления элемента iFrame, действительно, 
поисковые боты не видели разницы между содержимым фреймов и собственным контентом страницы. Но это уже давно не так: 
веб-краулеры теперь считают, что фреймы относятся к тому сайту, на котором расположены исходные HTML-документы.

Проблемы дублирования контента не существует, поэтому фреймы, подгружающие контент из доверенных источников, 
сами по себе никак не влияют на позицию сайта в поисковой выдаче — ни отрицательно, ни положительно. 
Однако, если размещать увлекательные материалы непосредственно на своем сайте, как уже было отмечено выше, 
это положительно скажется на продвижении.

В то же время использование контента из ненадежных источников может оказать негативное воздействие на отношение 
поисковиков сайтов. К примеру, если сайты-источники размещают нелегальный контент или материалы для взрослых, 
санкции поисковых систем не заставят себя ждать. По этой причине к подгрузке материалов из сторонних источников 
следует подходить осторожно, отдавая предпочтение самым надежным платформам.

## Устаревшие элементы `frame` и `frameset`

Тег iFrame не следует путать с устаревшими элементами `frame` и `frameset`, которые не поддерживаются в HTML5. 
Элемент iFrame предоставляет разработчику несколько полезных возможностей, но его использование требует опыта и взвешенного подхода.





### Полезные ссылки

[Спецификация](https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element)

[Дока iframe](https://doka.guide/html/iframe/)

[Доктайп iframe](https://htmlacademy.ru/blog/html-tags/iframe)

[SRC и SRCDOC в IFRAME HTML5: разница и применение](https://sky.pro/wiki/html/src-i-srcdoc-v-iframe-html-5-raznitsa-i-primenenie/)

[От <object> к <iframe> - другие технологии внедрения MDN](https://developer.mozilla.org/ru/docs/Learn/HTML/Multimedia_and_embedding/Other_embedding_technologies)

[iframe Skillfactory](https://blog.skillfactory.ru/glossary/iframe/)

[<iframe>: элемент встроенного фрейма MDN](https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#a_simple_iframe)

[GitHub — примеры кода, демонстрирующие srcdoc на практике](https://gist.github.com/search?q=iframe+srcdoc)

