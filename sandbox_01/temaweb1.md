# WEB-I ТЕМА 1 — HyperText Markeup Language (HTML)

На этом занятии мы познакомимся с языком *гипертекстовой разметки* — **HTML**:
- изучим устройство web-страницы;
- познакомимся с редактором кода;
- создадим свою первую страницу;
- познакомимся со структурой HTML


## Практическое задание:

- **Профиль** - создать профиль Петра I
- **Галерея изображений** - создать галерею изображений с гиперсылками


***


# Теория



# Корневая папка

Корневая папка (корневая директория/корневой каталог/корень документа) — это основная папка, 
в которой хранятся все каталоги и файлы сайта. Именно в эту папку загружается архив 
с файлами сайта и базы данных.

Если разместить файлы сайта не в ту папку, то вместо сайта отобразится ошибка 403. 
Правильно определить расположение корневой папки поможет инструкция ниже.


# Домен (доменное имя) 

Домен — это имя сайта. Набрав в строке браузера опредёленную комбинацию, 
например, «reg.ru», мы попадём на сайт.

Домен (доменное имя, доменный адрес) — это, простыми словами, «название» 
сайта. Понятия «домен» и «сайт» часто путают, но это не одно и то же. 
Сайт — это веб-страницы, которые отображаются в интернете, т. е. контент. 
А домен сайта — это его уникальный «адрес». Если у вашего сайта не будет 
домена, пользователи просто не найдут к нему дорогу и не увидят содержимое.


## Из чего состоит доменное имя

Все домены устроены иерархически: они состоят из частей (уровней). Домены 
третьего уровня создаются на базе доменов второго уровня, а домены второго 
уровня — на базе доменов первого. Познакомимся с видами доменов поближе:

- Домен второго (третьего, четвертого и т.д.) уровня или поддомен — левая 
часть домена до точки. На практике это любая комбинация символов, которую 
мы придумаем для названия своего будущего сайта (youtube.com, shop.reg.ru). 
Как корабль назовешь, как говорится, но это уже совсем другая SEO-история.

- Домен первого уровня или доменная зона — правая часть домена после точки. 
Эту часть не может задавать никто, кроме ICANN. Регистрируя «домен», мы 
придумываем домен второго уровня и выбираем зону. Они бывают географическими 
(.RU — Россия, .EU — страны Евросоюза, .AC — остров Вознесения и т. п.) или 
тематическими (от старожилов типа .COM. — коммерческой сферы, 
.BIZ — бизнес-сферы до new gTLD: .FLOWERS, .HEALTH, .ДЕТИ и т. д.).

- Домен нулевого уровня — точка после доменной зоны (reg.ru.), которая 
не отображается в адресной строке и опускается при вводе домена 
в строку браузера.

### Домены в DNS

Иерархию доменов можно представить в виде матрёшки: домен третьего уровня 
(например, **music**.youtube.com) входит в домен второго уровня (
music.**youtube**.com), а домен второго уровня входит в доменную зону 
(music.youtube.**com**). Все они включены в домен нулевого уровня (точку).


# DNS (Domain Name System)

Интернет — это бесчисленное количество физических устройств (серверов, компьютеров, 
планшетов и т.д.), связанных между собой в сеть. Любой сайт в интернете по факту 
находится на физическом устройстве. Каждое устройство имеет свой уникальный 
номер — **IP-адрес** вида **123.123.123.123**.

Чтобы попасть на сайт, нужно знать IP-адрес устройства, на котором расположен 
этот сайт. Для удобства работы в Интернете в *80-х годах была создана система 
доменных имен — DNS (Domain Name System)*. Смысл её в том, что каждому цифровому 
IP-адресу присваивается понятное буквенное имя (домен). Например, IP-адресу 
сервера **5.255.255.88** соответствует домен **yandex.ru**.

**DNS (система доменных имен)** – это «телефонная книга» Интернета. В качестве 
номера телефона в ней выступает IP-адрес, а в качестве наименований 
контактов — домены. В такую книгу можно внести не только «телефонный номер», 
но и дополнительную информацию о контакте («е-mail», «место работы» и т.п.).

**DNS ― это система, которая позволяет браузеру найти запрошенный пользователем 
сайт по имени домена**.


## DNS-серверы

Служба доменных имён работает благодаря DNS-cерверам. Именно эти жизненно важные 
«программы» хранят таблицы соответствий вида **«имя домена» — «IP-адрес»**. Кроме 
того, DNS-серверы служат для хранения **ресурсных записей доменов**.

В интернете огромное количество DNS-серверов и каждый выполняет свою функцию в 
общей системе. Служба Domain Name System необходима для того, чтобы мы могли 
без проблем находить свои любимые сайты, не запоминая вереницы цифр.

>*Внимание!*  
>**У домена должно быть несколько DNS-серверов**  
>DNS-сервер служит точкой отсчета для данных DNS вашего домена и, как правило, обслуживается поставщиком услуг хостинга. Сбой на DNS-сервере может вызвать неполадки в работе почты и сайта. Чтобы не допустить создания единой точки отказа, необходимо использовать хотя бы два не связанных между собой DNS-сервера. В некоторых странах DNS-серверы должны находиться в разных IP-сетях – это повышает надежность их работы. DNS-записи для домена, полученные с разных серверов, должны совпадать, но порядок, в котором они возвращаются, не имеет значения.


## Как работают DNS-серверы

1. Когда вы вводите в строке браузера доменное имя, например, yandex.ru, браузер 
ищет на вашем локальном компьютере **файл hosts**. В нём задаётся соответствие 
домена IP-адресу. Если запись существует для введённого домена, то сайт окроется.
Если записи нет, *браузер сформирует DNS-запрос к интернет-провайдеру,
чтобы тот нашёл IP-адрес домена*.

2. У каждого интернет-провайдера есть локальные (кеширующие) DNS-серверы. После 
получения запроса провайдер ищет в своём кеше запись о соответствии требуемого 
домена IP-адресу. Если такая запись есть, браузер получит IP-адрес. По этому 
адресу браузер обратится к хостингу, на котором расположен сайт, и пользователю 
откроется нужная страница. Если запись отсутствует, провайдер перенаправит 
DNS-запрос на корневые DNS-серверы.

3. Корневые DNS-серверы хранят информацию только о DNS-серверах, ответственных 
за доменные зоны. Корневой DNS-сервер не может предоставить провайдеру информацию 
об IP-адресе домена yandex.ru. Зато он отправит IP-адрес DNS-сервера доменной 
зоны, в данном случае зоны .RU

4. Теперь у интернет-провайдера есть IP-адрес DNS сервера доменной зоны .RU. 
Поэтому он обращается к этому DNS-серверу и запрашивает IP-адрес домена.

5. DNS-серверы зоны .RU хранят только информацию о DNS-серверах всех доменов 
в этой зоне, а не их IP-адреса. Поэтому DNS-серверы зоны подскажут 
интернет-провайдеру IP-адрес DNS-сервера домена yandex.ru

6. Интернет-провайдер получил IP-адрес DNS-сервера домена yandex.ru. Он 
обращается к DNS-серверу домена (например, к ns1.hosting.reg.ru) с запросом 
IP-адреса домена.

7. После получения запроса DNS-сервер сначала проверяет, есть ли у него 
информация о домене yandex.ru и искомый IP-адрес для него. В случае успеха 
DNS-сервер отправит IP-адрес домена интернет-провайдеру.

8. Интернет-провайдер получает IP-адрес домена и сохраняет его у себя в кеше. 
После этого он отправит браузеру результат DNS-запроса — IP-адрес 
домена yandex.ru.

9. Браузер обращается к хостингу по полученному IP-адресу (стрелка 9). 
Теперь пользователю открывается запрашиваемый сайт yandex.ru.


## Где находятся DNS-серверы

Основой DNS-системы являются корневые серверы. Их **всего 13**. Они принадлежат 
разным операторам и находятся **в Северной Америке**. Чтобы повысить устойчивость 
системы, были созданы копии основных серверов в разных странах. Таким образом, 
**корневых серверов стало 123**. Каждой копии присваивается тот же IP DNS-сервера, 
что и у главного устройства.

Официальная информация о том, где находится и кому принадлежит тот или иной 
действующий корневой DNS-сервер, публикуется на сайте:
- [Ассоциации операторов Корневых серверов DNS](https://root-servers.org/)

DNS-серверы расположены согласно интенсивности использования интернет-инфраструктуры. 
Больше всего серверов находится в Северной Америке, но копии серверов есть в:

- России,
- Европе,
- Австралии,
- Китае, Бразилии,
- ОАЭ,
- Исландии и в других странах.

В России реплики корневых серверов DNS находятся в:

- Москве,
- Санкт-Петербурге,
- Новосибирске,
- Ростове-на-Дону,
- Екатеринбурге.

**Зарегистрировал домен — пропиши DNS-серверы**

Прописывают DNS-серверы чаще всего парами. Один из DNS является первичным, 
а остальные серверы, которых может быть от 1 до 12 для каждого домена, 
называются вторичными. Это делается для лучшей отказоустойчивости: если 
выйдет из строя первичный DNS-сервер, домен и сайт продолжат свою работу 
благодаря вторичным.



## Типы записей DNS-сервера


В DNS есть файлы, в которых хранятся все необходимые связи между доменным 
именем и IP-адресами. Написанное в этом файле называется описанием DNS-зоны, 
или просто DNS-зоной.

Есть несколько видов записей, которые могут быть файле. Основные записи:

- А — IP-адрес веб-ресурса, который соответствует определённому имени домена,
- MX — адрес почтового сервера,
- CNAME — указывает аналог основному доменному имени. Эта запись чаще всего 
используется для прикрепления поддомена, 
- NS — адрес DNS-сервера, где хранятся все ресурсные записи,
- TXT — любая текстовая информация о домене,
- SPF — список серверов, которым позволено отправлять письма от имени указанного 
домена,
- SOA — исходная запись зоны, в которой указаны сведения о сервере.


# Ресурсные записи DNS

Информация о домене хранится на DNS-серверах. Чтобы внести её в систему DNS, 
нужно прописать ресурсные записи. С их помощью серверы делятся сведениями 
о доменах с другими серверами. Пока не прописаны ресурсные записи для домена, 
его нет в «телефонной книге» Интернета. Следовательно, работа сайта или почты 
на нём невозможна. Прежде чем приступать к указанию ресурсных записей, 
**нужно делегировать домен, то есть прописать для него DNS-серверы**.

Проверка записей DNS:

[Онлайн инструмент Dig][ref_002] – это веб-аналог UNIX-команды dig | Набора [инструментов администратора Google][ref_003]


## Запись A

**Запись A (address)** — одна из ключевых ресурсных записей Интернета. Она нужна 
для связи домена с IP-адресом сервера. Пока не прописана А-запись, ваш сайт 
не будет работать.

Когда вы вводите название сайта в адресную строку браузера, именно 
по А-записи DNS определяет, с какого сервера нужно открывать ваш сайт.

Примеры записи A:

Имя записи	 | Тип записи | Значение
---          | ---        | ---
site.ru      | A          | `123.123.123.123`
shop.site.ru | A          | `123.123.123.123`

где 123.123.123.123 — IP-адрес нужного вам сервера.


## Запись CNAME

**CNAME (Canonical name)** — запись, которая отвечает за привязку поддоменов 
(например, www.site.ru) к каноническому имени домена (site.ru) или другому 
домену.

Основная функция CNAME — дублирование ресурсных записей домена (A, MX, TXT) 
для различных поддоменов.

Примеры записи CNAME:

Имя записи   | Тип записи | Значение
---          | ---        | ---
www.site.ru  | CNAME      | `site.ru`
mail.site.ru | CNAME      | `webmail.hosting.reg.ru`

Если вы пропишете CNAME для поддомена www.site.ru и укажете значение site.ru, 
сайт будет открываться с того же IP-адреса, что и site.ru. Если вы пропишете CNAME 
для mail.site.ru и укажете значение webmail.hosting.reg.ru, то на mail.site.ru 
будут распространятся те же ресурсные записи, что для webmail.hosting.reg.ru.

> Использование записи CNAME исключает использование других ресурсных записей 
> для данного поддомена, то есть для поддомена mail.site.ru или www.site.ru 
> нельзя одновременно добавить и запись A и запись CNAME.


##  Запись MX

MX-запись — это txt-запись, которая содержит информацию о почтовых серверах, 
обрабатывающих почту.

MX-запись – это запись, **отвечающая за сервер, через который будет работать 
почта**. Записи MX критически важны для работы почты. Благодаря им отправляющая 
сторона «понимает», на какой сервер нужно отправлять почту для вашего домена.

Примеры записи MX:

Имя записи| Тип записи | Приоритет | Значение
---       | ---        | ---       | ---
site.ru   | MX         | 10        | `mx1.hosting.reg.ru`
site.ru   | MX         | 15        | `mx2.hosting.reg.ru`

где `mx1.hosting.reg.ru` — нужный вам почтовый сервер.

Обычно указывается два почтовых сервера, чтобы в случае недоступности одного из 
них почта всё же была отправлена на другой. Приоритет записи определяет, на какой 
сервер нужно отправлять почту в первую очередь. Чем меньше число, тем выше приоритет. 
Таким образом, для доменного имени `site.ru` почтовый сервер `mx1.hosting.reg.ru` 
является основным, а `mx2.hosting.reg.ru` выступает второстепенным. Если приоритет 
одинаковый, сервер выбирается случайным образом.

Данные исследования MX-запись с помощью с помощью [PowerTool][ref_013] от Power-Dmarc:

Предпочтение | Имя хоста     | IP-адрес     | Название организации
---          | ---           | ---          | ---
10 	         | mx1.beget.com | 185.78.30.48 | Hosting servers
\            | \           | 185.78.30.71 | Hosting servers
-            | -             | 5.101.158.68 | Hosting servers
20 	         | mx2.beget.com | 185.78.30.71 | Hosting servers
             |               | 185.78.30.48 | Hosting servers
             |               | 5.101.158.68 | Hosting servers


**Проверка MX**

[Проверка MX][ref_004] – это удобный инструмент для проверки конфигурации DNS-серверов. Он помогает обнаруживать типичные ошибки настройки записей MX.

MX-запись — это txt-запись, которая содержит информацию о почтовых серверах, обрабатывающих почту.

### Как происходит отправка электронных писем

У любого почтового ящика есть доменное имя. Оно указывает, где находится почта. Например, доменное имя может выглядеть так: test.domain.com. При отправке письма имя ставят после значка @, после чего оно выглядит так: @test.domain.com.

Технически доменное имя — это запись в базе данных, которая находится на сервере. Сервер — это мощный компьютер, задача которого управлять почтой и обрабатывать письма. Он может располагаться где угодно: в соседнем городе, стране или на другом континенте. У серверов есть буквенные имена и адреса, которые помогают находить их в интернете. Адреса называются IP и выглядят как набор цифр и точек: 198.102.434.8.

Когда почтовый агент, например, Gmail отправляет письмо, фактически он отправляет его на IP-адрес сервера получателя. Но IP-адреса у агента нет, а есть только доменное имя — @test.domain.com. Чтобы найти IP-адрес сервера, агент обращается к MX-записи получателя. Внутри MX-записи перечислены буквенные имена серверов, которые соответствуют доменному имени @test.domain.com.

Однако и по буквенному имени агент Gmail не может найти IP-адрес сервера получателя. Поэтому он использует специальную службу DNS. Задача DNS переводить буквенное имя сервера получателя в соответствующий ему IP-адрес.

В итоге агент делает так:

    Сначала ‎‎заглядывает‎ в DNS.
    Считывает MX-запись отправителя.
    По доменному имени почты находит в ней буквенное имя сервера получателя.
    Через имя с помощью DNS вычисляет IP сервера и далее на этот IP пересылает письмо.

Так получается, что MX-запись которая содержит информацию о почтовых серверах, обрабатывающих почту. Если MX-запись настроена неверно или её нет, то письма не будут доставлены получателю.


# Запись TXT

**TXT (Text string)** — *запись, которая содержит любую текстовую информацию 
о домене*. Записи TXT используются для различных целей: 
- подтверждения права собственности на домен, 
- обеспечения безопасности электронной почты, 
- а также подтверждения SSL-сертификата. 

Часто применяется для проверок на право владения доменом при подключении 
дополнительных сервисов, а также как контейнер для **записи SPF** 
и **ключа DKIM**. 

Можно прописывать неограниченное количество TXT-записей, если они 
не конфликтуют друг с другом.


# Записи SPF, DKIM и DMARC

DMARC, SPF и DKIM – эти 3 строки в вашей зоне DNS работают вместе, 
чтобы предотвратить попадание ваших писем в спам:

- **SPF** (**Sender Policy Framework** – структура политики отправителей), 
- **DKIM** (**DomainKeys Identified Mail** – идентифицированная почта с помощью 
ключей домена) 
- **DMARC** (**Domain-based Message Authentication, Reporting & Conformance** – проверка
подлинности сообщений, отчетность и соответствие на основе домена) 


## Запись SPF

**SPF-запись (Sender Policy Framework)** содержит информацию о списке серверов, 
которые имеют право отправлять письма от имени заданного домена. Позволяет 
избежать несанкционированного использования, защитить домен от спуфинга и п
редотвратить попадание почты, отправляемой из организации, в папку "Спам".
Настройка SPF прописывается в TXT-записи для домена.

*Пример записи SPF:*

Имя записи | Тип записи | Значение
---        | ---        | ---
site.ru    | TXT        | `v=spf1 include:_spf.hosting.reg.ru ip4:123.123.123.123 a mx ~all`

где `123.123.123.123` — IP-адрес нужного вам сервера.

В этом примере:

- **v=spf1** — определяет версию используемой записи SPF;
- **include:_spf.hosting.reg.ru** — включает в запись SPF значение SPF-записи 
другого домена. То есть для домена будут действовать все значения записи SPF 
для домена «_spf.hosting.reg.ru»;
- **ip4:123.123.123.123** — разрешает приём почты с IP-адреса 123.123.123.123;
- **a** — разрешает приём почты с сервера, IP-адрес которого стоит в ресурсной 
A-записи домена. Проще говоря, с сервера, где размещён сайт;
- **mx** — разрешает приём почты, если отправляющий сервер указан в одной 
из записей MX для домена. mx — разрешает отправлять письма c адреса, который
указан в mx записи домена (для a и mx можно указать и другой домен, например,
при значении a:example.com, будет разрешена а запись не домена отправителя,
а example.com)\
Так же можно добавлять и отдельные ip адреса, используя ip4: и ip6:. Например
(смотрите выше), ip4:1.1.1.1 ip6: 2001:0DB8:AA10:0001:0000:0000:0000:00FB.
Еще есть `include:` (`include:spf.example.com`), позволяющий дополнительно
подключать spf записи другого домена. Это все можно комбинировать через пробел.
Если же нужно просто использовать запись с другого домена, не дополняя её,
то лучше всего использовать `redirect:` (`redirect:spf.example.com`);
- **~all** — (с ключем **«~»**) если письмо пришло с сервера, который не входит в вышеперечисленный 
список, его стоит **проанализировать более тщательно**.
  - Также иногда используется **-all** —(cключем **«-»**) в этом случае письмо не проходит
дополнительных проверок и **сразу отвергается**.\
*Помимо «~» и «-», для параметра «all» существуют ещё ключи:*
  - ключ **«+»** — **принимать почту**,
  - ключ **«?»** — **воспринимать письмо нейтрально**.

### Важно! Должна быть одна запись SPF

У домена может быть только одна запись SPF, но в ней можно указать несколько серверов 
и сторонних почтовых сервисов:
- иногда запись SPF1 уже содержится в настройках. Тогда нужно добавить в эту запись еще одно
значение `include:spf.unisender.com ~all`

Если у вас есть две отдельные записи записи SPF TXT, ваши электронные письма не смогут пройти 
аутентификацию SPF и вернут **ошибку PermError**. 

Мы можем использовать [MXToolbox][ref-010] для сканирования ваших записей DNS на наличие более 
одной записи SPF.

Если у вас есть несколько записей SPF, простое решение — объединить эти записи в одну запись.

По данным Alexa, каждый шестой домен с записью SPF использует неправильный формат. Другими 
словами, эти домены имеют несколько записей TXT, которые следует объединить. Поэтому определенно 
стоит проверить, нет ли у вас лишних или нежелательных записей SPF. 

В **Разрешенные домены** необходимо добавьте `includeдля` каждого домена, После объединения 
правил SPF ваша объединенная запись будет выглядеть следующим образом:

`v=spf1 include:_spf.yandex.ru include:beget.com ~all`

если, например, хотим настроить настроить DNS Бегет только на одну почту яндекса, то пишеим:

`v=spf1 redirect=_spf.yandex.net`

Если вы хотите отправлять письма не только с серверов Яндекса, укажите дополнительные серверы в таком формате:

`v=spf1 ip4:IP-1 ip4:IP-2 ip4:IP-3 include:_spf.yandex.net ~all`

Где `IP-1`, `IP-2`, `IP-3` — IP-адреса дополнительных серверов, либо `include:beget.com`

Имейте в виду, что для записей SPF существуют ограничения:
- В операторе может быть максимум 10 поисков домена (например, include)
- Длина оператора не должна превышать 255 символов.

[Несколько записей SPF: как их объединить][ref_009]

 
*SPF простыми словами:*

>*SPF показывает*, разрешено ли конкретному серверу отправлять письма с этого домена. Сервер
>определяется по IP-адресу. Например, когда вы отправляете рассылку через Unisender
>или настраиваете корпоративную почту на Mail.ru, вы делегируете серверам Unisender
>и Mail.ru право отправлять письма с вашего домена.


## Запись DKIM

**Запись DKIM** (**DomainKeys Identified Mail**) — технология проверки электронной почты, 
с помощью которой можно вычислить поддельные письма. Идентифицированная почта с ключами домена 
(DKIM) DKIM добавляет в письмо цифровую подпись. Благодаря ей почтовые провайдеры (Mail.ru, 
Gmail) могут проверить, что сообщение отправлено именно с указанного домена.

Подпись DKIM — это TXT-запись, которую добавляют в настройки DNS-зоны сайта.

*Пример DKIM:*

Имя записи               | Тип записи | Значение
---                      | ---        | ---
s1._domainkey.domain.ru  | TXT        | `v=DKIM1; k=rsa; p=XXXXXXXXXXXXXXXXXXXXX,`

где:
- `v` — версия DKIM, всегда принимает значение v=DKIM1
- `k` — тип ключа, всегда k=rsa
- `p` — открытый ключ (Public key)
- `s1` - селектор в записи `s1._domainkey.vniif.ru`

Примеры селектора DKIM (DKIM Selector)

Селектор – это первая часть значения в поле 1. Имя хоста DNS (название записи TXT). Если ваше 
имя хоста `s1._domainkey.domain.ru` (т.е. ваша запись опубликована на этом поддомене), `s1` - это 
ваш селектор. Вы можете настроить любой селектор по своему выбору, он может быть буквенно-цифровым 
значением и может содержать дефисы, при этом дефис не может быть первым символом. 
Вот несколько примеров селекторов DKIM:

`s1._domainkey.domain.com`

`mn009._domainkey.domain.com`

`abc-12345._domainkey.domain.com`

Вы можете обнаружить селектор DKIM для вашего домена в виде тега "s=" в заголовке подписи DKIM. Это строковая переменная, которая помогает указать на открытый ключ DKIM в DNS вашего домена.

Поиск DKIM с помощью [PowerTool][ref_013] от Power-Dmarc


### Зачем нужна DKIM-подпись

**Защищает от мошенников**. DKIM-подпись не позволит спамерам отправлять письма от 
вашего имени. Вместе с SPF и DMARC эта технология защитит ваших подписчиков от мошенников, 
в том числе от кражи персональных данных.

**Повышает доставляемость**. DKIM улучшает репутацию домена. По DKIM сервер-получатель 
определяет подлинность отправителя и его общий рейтинг. Письма с хорошей репутацией имеют 
больше шансов попасть во «Входящие».\
DKIM работает как паспорт: вы предъявляете его почтовому провайдеру, а он пропускает 
вас в инбокс.

**Дает доступ к постмастерам**. Постмастеры — сервисы почтовых служб для аналитики 
рассылок. Они помогают следить за доставляемостью, открытиями, отписками и жалобами 
на спам. Чтобы подключить статистику в постмастере, у вас должна быть настроена 
email-аутентификация. DKIM — одна из составляющих email-аутентификации.

*Работа DKIM простыми словами*

>DKIM работает так: в письме есть зашифрованные данные о том, кем и когда было отправлено 
письмо. Почтовый провайдер, Gmail или Mail.ru, получает эти данные вместе с письмом. 
Провайдер расшифровывает их с помощью публичного ключа, выложенного на домене, с которого 
отправлено письмо. Если данные совпадают — значит, это честный отправитель, письмо можно 
пропускать во «Входящие». Если нет — мошенник, письмо отправляется в «Спам».

### Как настроить DKIM-подпись

Чтобы настроить DKIM, вам нужен доступ к DNS-зоне сайта и корпоративная почта. Обычно 
записи SPF и DKIM формируются в сервисе рассылок и добавляются через личный кабинет 
на хостинге (узнать хостинг вашего сайта можно с помощью специальных сервисов, 
например [NsLookup][ref_008]). 

Подтверждение DKIM-записи занимает от часа до нескольких дней.

[Бесплатный генератор записей DKIM][ref_012]

### Проверка DKIM-подписи

После настройки DKIM-подписи, стоит проверить, корректно ли она работает. Это можно 
сделать с помощью вашего сервиса рассылок или стороннего сервиса, например, 
[Mailtester][ref_005].

#### Проверка c помощью сервиса Mailtester

[MailTester.com][ref_005] — сервис, с помощью которого можно протестировать письмо, в том числе 
проверить DKIM-подпись. MailTester дает полный отчет по доставляемости, а также проверяет 
настройки email-аутентификации:
- Сначала сервис предлагает отправить тестовое письмо на указанный адрес.
- После того как вы отправили письмо для проверки, нажмите кнопку «Затем проверьте оценку». 
Сервис оценит сообщение по шкале от 1 до 10 баллов в зависимости от того, с какой 
вероятностью оно попадёт во «Входящие». Если у письма низкий рейтинг, скорее всего, 
оно попадет в «Спам». 

Чтобы проверить информацию о DKIM-подписи домена, нажмите на плюс во втором пункте 
(про рейтинг писем).

### Главное о DKIM

- Это технология проверки электронной почты, с помощью которой можно вычислить поддельные 
письма.
- Добавляет в письмо цифровую подпись. Благодаря ей почтовые провайдеры могут проверить, 
что сообщение отправлено именно с указанного домена.
- Подпись DKIM - это ТХТ-запись, которую добавляют в настройки DNS-зоны сайта.
- Защищает от мошенников, повышает доставляемость, дает доступ к постмастерам.


## Запись DMARC

Запись DMARC – это запись TXT, содержащая инструкции о том, как почтовые серверы должны 
обрабатывать сообщения, не прошедшие аутентификацию электронной почты.

Используя записи DMARC, вы можете контролировать, должны ли получатели электронной почты 
отклонять, помещать в карантин или ничего не делать с подозрительным письмом.:
- указывает почтовому провайдеру, что делать с письмом в зависимости от результатов прочтения DKIM и SPF;
- говорит серверу отправить отчет на почту администратора домена (то есть вам или вашему системному администратору) с информацией, какие письма были отправлены и как провайдер поступил с письмами.
- указывает почтовому провайдеру, что делать с письмом в зависимости от результатов прочтения DKIM и SPF;
- говорит серверу отправить отчет на почту администратора домена (то есть вам или вашему системному администратору) с информацией, какие письма были отправлены и как провайдер поступил с письмами.

*Пример записи DMARC:*

Типичная запись DMARC содержит как минимум три важных компонента (или пары тег-значение). 
Рассмотрим этот пример записи DMARC: 

Имя записи          | Тип записи | Значение
---                 | ---        | ---
_dmarc.example.com  | TXT        | `v=DMARC1; p=reject; rua=mailto:dmarc@yourdomain.com`

Здесь у нас есть имя записи вида `_dmarc.example.com` и три тега: `v`, `p` и `rua` , которые имеют значения `DMARC1`, `ignore`, `mailto: dmarc@yourdomain.com`:
- TXT-запись `_dmarc.example.com` (где вместо `example.com` должен быть ваш домен)
- Тег **v** указывает версию DMARC.
- Тег **p**— это политика (или действие, которое необходимо выполнить, если электронная 
почта не проходит проверку DMARC)
- Тег **rua** — это адрес электронной почты , на который будут отправляться отчеты DMARC. 
Это может быть адрес электронной почты вашей хостинговой компании, адрес электронной почты 
вашего регистратора или ваш собственный.

Тег `p` обозначает три возможные *политики DMARC*: 

  - **None**: никаких действий не предпринимается для сообщений, не прошедших проверку DMARC, 
но отчеты по-прежнему будут отправляться вам, чтобы вы могли отслеживать, что происходит 
с вашими электронными письмами. Вы можете получить сообщение об ошибке «Политика DMARC 
не включена», если для политики установлено значение «Нет». 
  - **Quarantine**: сообщения, не прошедшие проверку DMARC, помещаются в папку нежелательной 
почты получателей. 
  - **Reject**:  все сообщения электронной почты, не прошедшие проверку подлинности, полностью 
отклоняются и никогда не доходят до получателя. Другими словами, определенная здесь 
политика заключается в отклонении сообщения, если оно не проходит проверку подлинности.

*Работа DMARC простыми словами:*

>Допустим, есть две страны (домена), причем пересечение границы первой страны (получателя) гражданами второй страны (отправителя) разрешено второй страной только при наличии паспорта (SPF, DKIM).\
>На границу попадает гражданин второй страны (во всяком случае, он так уверяет). Паспортный контроль (антиспам-фильтр получателя) просит паспорт, но слышит в ответ, что паспорта нет. Зная, что вторая страна не разрешает впускать таких граждан (DMARC), пограничник запрещает въезд и отправляет первой стране отчет, что была попытка въезда в первую страну предположительно гражданином второй страны. Документов не было, поэтому въезд был запрещен.


### Как работает DMARC?

Протокол DMARC проверяет записи SPF и DKIM вашего домена. Если почтовый сервер не может 
найти записи SPF или DKIM, он смотрит на DMARC, чтобы выяснить, что делать с исходящей 
почтой.

В зависимости от содержимого записи DMARC сервер может:

- Поместите свои электронные письма в карантин
- Отправьте их в папку нежелательной почты или спама.
- Откажитесь от них вообще.

Вот почему лучше всего настраивать DKIM, SPF и DMARC вместе. Таким образом, сервер 
электронной почты может легко отделить электронные письма от законного отправителя 
от любых спам-сообщений, отправленных с использованием вашего домена. 

Записи DMARC не требуются для отправки электронных писем. Однако настоятельно рекомендуется 
добавить записи DMARC в ваш DNS. Это связано с тем, что записи DMARC защищают вас и ваших 
пользователей от опасных действий, таких как фишинг и несанкционированное использование 
вашего почтового домена.

### Сколько записей DMARC я могу иметь?

Вы можете иметь **только одну запись DMARC для одного домена или поддомена**. Если у вас есть 
несколько записей DMARC на одном уровне домена, это может запутать почтовые серверы. 
Обычно это означает, что ваши записи DMARC не смогут применять какие-либо правила 
и политики, которые вы могли определить для обработки неаутентифицированных электронных 
писем. 

В качестве общего руководства вам не нужна запись DMARC, если вы отправляете электронные 
письма с домена, который вы не контролируете, например с адреса электронной почты Gmail.

[Проверка записей DMARC][ref_011] 

[Путеводитель по DMARC][ref_007]

[Как прописать DMARC][ref_006]


# Записи NS, PTR, SOA 

Записи NS, PTR, SOA **являются служебными и, как правило, настраиваются автоматически**


## Запись NS

**NS-запись (Authoritative name server)** указывает на DNS-серверы, которые 
отвечают за хранение остальных ресурсных записей домена. Количество NS записей 
должно строго соответствовать количеству всех обслуживающих его серверов. 
Критически важна для работы службы DNS.


## Запись PTR

PTR — обратная DNS-запись, которая связывает IP-адрес сервера с его 
каноническим именем (доменом). Широко используется при фильтрации почты. 
Если вы хотите, чтобы письма, отправленные с вашего сервера, благополучно 
достигали адресата, пропишите для сервера корректную PTR-запись.

Запись PTR или запись-указатель — это тип записи DNS, предназначенный для предотвращения 
спама. Запись PTR указывает с IP-адреса вашего сервера на ваше доменное имя.

### Что такое rDNS?

rDNS означает «обратный DNS». Общие записи DNS (например, записи A) представляют собой 
прямой поиск: они берут имя домена и находят по нему IP-адрес. Обратные DNS-записи, такие 
как PTR, переворачивают это и работают противоположным образом: они берут IP-адрес и ищут 
доменное имя.

### Как обновить запись PTR?

Если вам нужно обновить запись PTR, обратитесь к своему хостинг-провайдеру или 
регистратору. В большинстве случаев вы не можете обновить свою запись PTR самостоятельно.

### Нужны ли записи PTR?

Да. PTR является частью более широкой системы проверок DNS, которая предотвращает 
попадание отправляемых вами электронных писем в спам. 

Записи PTR не создаются в зоне DNS вашего домена. Они создаются в другой зоне, называемой 
«зоной обратного DNS». А когда сервер ищет запись PTR, это называется «обратным» поиском.

### Об обратном просмотре (Reverse Lookup)

Обратный поиск (Reverse Lookup) важен, поскольку он выявляет доменное имя (или имена), 
связанные с IP-адресом. Это помогает не дать спамерам использовать ваш домен для рассылки 
нежелательной почты. 

### FCrDNS

Вы также можете увидеть упоминание FCrDNS, что означает «обратный DNS с прямым 
подтверждением» или «полный обратный DNS». В общих чертах это означает, что PTR 
и A-записи совпадают.


## Запись SOA 

**SOA-запись (Start of Authority)** — начальная запись зоны, которая указывает 
местоположение эталонной записи о домене. Она содержит в себе контактную 
информацию лица, ответственного за данную зону, время кэширования информации 
на серверах и данные о взаимодействии DNS. *SOA-запись создается автоматически*. 
**Удалить ее нельзя**.


Какие параметры хранятся в SOA-записи:

- **TTL** – время, в течение которого информация будет кешироваться другими DNS-серверами.

- **Hostname** – контактный адрес лица, который отвечает за администрирование файла зоны.

- **Serial number** – 32-разрядное число, которое содержит в себе серийный номер файла 
зоны. Изменяется при каждом обновлении зоны.

- **Refresh** – время (в секундах) ожидания ответа вторичного DNS перед запросом 
SOA-записи с первичных серверов. По истечении данного времени вторичный DNS 
обращается к первичному для получения копии текущей SOA-записи. Первичный 
DNS-сервер выполняет этот запрос. Вторичный DNS-сервер сравнивает полученный 
серийный номер зоны с имеющимся. Если они отличаются, то осуществляется запрос 
к первичному DNS-серверу на трансфер зоны.

- **Retry** – если сервер недоступен, то в по истечении времени (в секундах), 
указанного в данном параметре, сервер повторно попытается синхронизировать 
информацию с первичных DNS-серверов.

- **Expire** – время (в секундах), в течение которого вторичный DNS будет 
пытаться завершить синхронизацию зоны с первичным. Если это время истечет 
до того, как синхронизация закончится, то зона на вторичном DNS-сервере 
перестанет обслуживать запросы об этой зоне.

- **Minimum TTL** – время жизни кэша для негативного ответа на запрос в зонe.

[Что такое SOA-запись и как ее проверить][ref_001]

# Сервисы

[PowerTool][ref_013] от Power-Dmarc

Этот инструмент позволяет искать и находить ошибки в записях SPF, DMARC, DKIM, BIMI, MTA-STS, TLS-RPT, NS, MX DNS вашего домена в одном месте. Она также позволяет просматривать информацию о whois вашего домена и статус черного списка ваших IP-адресов, PTR DNS записи и результаты проверки FCrDNS.

## Источники

[Набора инструментов администратора Google][ref_003]

[Что такое DNS простыми словами](https://help.reg.ru/hc/ru/articles/4408047119761/)

[Что такое домен - доменное имя](https://help.reg.ru/hc/ru/articles/4408047486097/)

[Что такое ресурсные записи DNS](https://help.reg.ru/hc/ru/articles/4408047057937?rtm_source=e-mail&rtm_medium=e-mail&rtm_campaign=NewsSingle_40415)

[Как очистить кэш браузера](https://help.reg.ru/hc/ru/articles/4408046921745/)

[Настройка сети: что такое VPN](https://www.reg.ru/blog/nastrojka-seti-chto-takoe-vpn/?_gl=1*d5qyro*_ga*MTQ1NDQyNTU0My4xNjQ3MjYxODY0*_ga_N9GCQPR82H*MTY0NzI2MTg2My4xLjEuMTY0NzI2NDc4OS41Ng..)

[//]: # (Это реферальные ссылки reference links которые поозоватеь не видит и комментарий тоже не видит)

[ref_001]:<https://help.reg.ru/hc/ru/articles/4408047470865>
[ref_002]:<https://toolbox.googleapps.com/apps/dig/>
[ref_003]:<https://toolbox.googleapps.com/apps/main/>
[ref_004]:<https://toolbox.googleapps.com/apps/checkmx/>
[ref_005]:<https://www.mail-tester.com/>
[ref_006]:<https://www.unisender.com/ru/blog/sovety/putevoditel-po-dmarc-chto-eto-zachem-nuzhno-i-kak-propisat/>
[ref_007]:<https://www.unisender.com/ru/glossary/dmarc/#anchor-1>
[ref_008]:<https://www.nslookup.io/>
[ref_009]:<https://wpmailsmtp.com/fix-multiple-spf-records/>
[ref-010]:<https://mxtoolbox.com/spf.aspx>
[ref_011]:<https://dmarcian.com/dmarc-inspector/>
[ref_012]:<https://powerdmarc.com/ru/dkim-record-generator/>
[ref_013]:<https://powerdmarc.com/ru/power-dmarc-toolbox/>
